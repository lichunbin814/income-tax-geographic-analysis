<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>台灣所得地圖</title>
    <!-- CSS -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/openlayers/4.6.4/ol.css"> -->
    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css"> -->
    <!-- <link rel="stylesheet" href="/assets/map/css/ol3-sidebar.css" /> -->
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
    
    <!-- 先載入基礎函式庫 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script> -->
    <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/openlayers/4.6.4/ol.js"></script> -->
    <!-- 確保 ol3-sidebar.js 在 OpenLayers 之後載入 -->
    <!-- <script src="/assets/map/js/ol3-sidebar.js"></script> -->
    
    <!-- 初始化必要的全域變數 -->
    <!-- <script>
      // OpenLayers 的投影設定
      var projection = ol.proj.get('EPSG:3857');
      var projectionExtent = projection.getExtent();
      var size = ol.extent.getWidth(projectionExtent) / 256;
      var resolutions = new Array(20);
      var matrixIds = new Array(20);
      for (var z = 0; z < 20; ++z) {
        resolutions[z] = size / Math.pow(2, z);
        matrixIds[z] = z;
      }
    </script> -->
    
    <script>
      // 等待 DOM 和 React 完全載入後再初始化地圖
      window.addEventListener('load', function() {
        // 先載入必要的腳本
        function loadScript(src) {
          return new Promise((resolve, reject) => {
            const script = document.createElement('script');
            script.src = src;
            script.onload = resolve;
            script.onerror = reject;
            document.body.appendChild(script);
          });
        }

        // 按順序載入腳本
        async function initializeMap() {
          try {
            // await loadScript('/assets/map/js/routie.min.js');
            await loadScript('/assets/map/main.js');
          } catch (error) {
            console.error('Error loading scripts:', error);
          }
        }

        // 給一點延遲確保 React 元件都已經渲染完成
        setTimeout(initializeMap);
      });
    </script>
  </body>
</html>

